<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Multi-AZ and Multi-Region Support - EDA SLURM Cluster on AWS</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">EDA SLURM Cluster on AWS</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">AWS EDA Slurm Cluster</a>
                            </li>
                            <li class="navitem">
                                <a href="../deploy/" class="nav-link">Deploy the Cluster</a>
                            </li>
                            <li class="navitem">
                                <a href="../run_jobs/" class="nav-link">Run Jobs</a>
                            </li>
                            <li class="navitem">
                                <a href="../onprem/" class="nav-link">On-Premises Integration</a>
                            </li>
                            <li class="navitem">
                                <a href="../soca_integration/" class="nav-link">SOCA Integration</a>
                            </li>
                            <li class="navitem">
                                <a href="../f1-ami/" class="nav-link">SLURM AMI Based On FPGA Developer AMI</a>
                            </li>
                            <li class="navitem">
                                <a href="../federation/" class="nav-link">Federation</a>
                            </li>
                            <li class="navitem">
                                <a href="../implementation/" class="nav-link">Implementation Details</a>
                            </li>
                            <li class="navitem">
                                <a href="../debug/" class="nav-link">Debug</a>
                            </li>
                            <li class="navitem">
                                <a href="../todo/" class="nav-link">To Do List</a>
                            </li>
                            <li class="navitem">
                                <a href="../mkdocs/" class="nav-link">mkdocs</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a href="https://github.com/aws-samples/aws-eda-slurm-cluster/edit/master/docs/multi-region.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#multi-az-and-multi-region-support" class="nav-link">Multi-AZ and Multi-Region Support</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#computenodesecuritygroup" class="nav-link">ComputeNodeSecurityGroup</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="multi-az-and-multi-region-support">Multi-AZ and Multi-Region Support</h1>
<p>Set up Route53 private hosted zone.
Create A records for all file systems that must be accessed by compute nodes.
The Amazon DNS names will NOT be available in other VPCs so cannot use CNAME records; they must be A records with the IP address of the file system.
Make sure that hosted zone is connected to all VPCs in all regions that are used by the slurm cluster.</p>
<p>Make sure that file system security groups allow access from all slurm VPCs.</p>
<p>Set up VPC peering connections between all VPCs.
Create routes between the VPCs.</p>
<p>All of the compute nodes in the cluster should share the same file directory structure and have network
connectivity to all other nodes and to the slurm controller and slurmdbd instances.</p>
<p>The slurm file system contains all of the configuration files and executables, so it must be accessible
by all nodes.
The easiest way to accomplish this is to simply mount the file system across the network.
Initial file accesses may be slow, but subsequent accesses should be cached in the nfs clients so it shouldn't
be an issue for performance.</p>
<p>Working directories can also be mounted across AZs and regions, but the performance implications may be significant.
File system performance issues related to network latency can be resolved by using NetApp FlexCache volumes in
AZs and regions.
Since the file system architecture can be very implementation specific, it is not handled automatically.</p>
<p>What is done, is that the required structures are provided to allow you to easily configure the cluster to use whatever file systems
and volumes you have created.
The main mechanism is the creation of an Amazon Route53 hosted zone in each region with entries for the slurm controllers, the slurmdbd instance,
and all file systems used by the cluster.
This allows compute node AMIs to be created in the origin region and then copied to the other regions.
The DNS entries can be updated after deployment to resolve to local FlexCache volumes if they are created.</p>
<p>The other regional resources required to launch instances in other regions are ssh key pairs and security groups.
IAM roles are not regional so they can be shared across regions.</p>
<p>Regional resources that must be provided:
* Subnet IDs
* EC2 Keypairs</p>
<p>Regional resources that will be created:
* Route53 private hosted zone
* ComputeNodeSecurityGroup</p>
<h2 id="computenodesecuritygroup">ComputeNodeSecurityGroup</h2></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
